define("wiki-common:widget/component/searchbar-n/searchbar.js",function(e,t,i){function s(e){function t(e){window.baidu=window.baidu||{},window.baidu.sug=function(t){var i=t.q||"",n=("bollean"==typeof t.p?req.p:!1,t.s||[]);n.unshift(i),s.list=n,s.renderSuggestion(e)}}var i="",s={selected:0,list:[],searchInOtherProducts:function(e,t,i){var s=n.trim(e.find("#query").val());location.href=s?t+encodeURIComponent(s):i},requestSuggestion:function(e){e&&""!=n.trim(e)?n.ajax({url:"https://gsp0.baidu.com/8qUZeT8a2gU2pMbgoY3K/su?wd="+encodeURIComponent(e)+"&prod=baike",dataType:"script",scriptCharset:"GBK"}):window.baidu.sug({q:"",p:!1,s:[]})},renderSuggestion:function(e){if(s.list.length<=1)e.find("#suggestion").hide();else{s.list.length>5?e.find("#suggestion").addClass("sugbg"):e.find("#suggestion").removeClass("sugbg");for(var t="",i=1;i<s.list.length;i++)t+=s.list[i].match(s.list[0])?'<li class="matched">'+s.list[i].replace(s.list[0],'<span class="highlight">'+s.list[0]+"</span>")+"</li>":"<li>"+n("<div>").text(s.list[i]).html()+"</li>";e.find("#suggestion > div").html(t),e.find("#suggestion").show()}s.selected=0},hoverSuggestion:function(e){s.list.length>0?(e.find("#suggestion div li").removeClass("selected"),s.selected-1>=0&&e.find("#suggestion div li").eq(s.selected-1).addClass("selected")):s.requestSuggestion(n.trim(e.find("#query").val()))},selectSuggestion:function(e){s.list.length>0&&e.find("#query").val(s.list[s.selected])},closeSuggestion:function(e){s.selected=0,s.list=[],e.find("#suggestion > div").html(""),e.find("#suggestion").hide()},input:function(e){clearTimeout(i);var t=n.trim(e.find("#query").val());i=setTimeout(function(){s.requestSuggestion(t)},200)},search:function(e){var t=n.trim(e.find("#query").val());""==t&&e.find("#query").val("百度百科"),e.find("#searchForm").submit(),s.closeSuggestion(e)},searchLemma:function(e){var t=n.trim(e.find("#query").val());""==t&&e.find("#query").val("百度百科"),e.find("#searchLemmaQuery").val(e.find("#query").val()),e.find("#searchLemmaForm").submit()}};e.on("searchInOtherProducts",function(e,t){var i=t.attr("data-href"),o=t.attr("href");i&&o&&s.searchInOtherProducts(n(this),i,o)}),e.on("suggestion:shiftUp",function(){s.selected=(s.selected-1)%s.list.length>=0?(s.selected-1)%s.list.length:(s.selected-1)%s.list.length+s.list.length,s.hoverSuggestion(n(this)),s.selectSuggestion(n(this))}),e.on("suggestion:shiftDown",function(){s.selected=(s.selected+1)%s.list.length<s.list.length?(s.selected+1)%s.list.length:(s.selected+1)%s.list.length-s.list.length,s.hoverSuggestion(n(this)),s.selectSuggestion(n(this))}),e.on("suggestion:hover",function(e,t){s.selected=t.index()+1,s.hoverSuggestion(n(this))}),e.on("suggestion:leave",function(){s.selected=0,s.hoverSuggestion(n(this))}),e.on("suggestion:close",function(){s.closeSuggestion(n(this))}),e.on("suggestion:select",function(){s.selectSuggestion(n(this))}),e.on("searchbar:focus",function(){t(n(this))}),e.on("searchbar:input",function(){t(n(this)),s.input(n(this))}),e.on("searchbar:search",function(){s.search(n(this))}),e.on("searchbar:searchLemma",function(){s.searchLemma(n(this))}),e.find(".search .nav a").on("click",function(){return n(this).trigger("searchInOtherProducts",[n(this)]),!1}),e.find("#query").on("keydown",function(e){switch(e.keyCode){case 38:n(this).trigger("suggestion:shiftUp"),e.preventDefault();break;case 40:n(this).trigger("suggestion:shiftDown"),e.preventDefault();break;case 9:case 27:n(this).trigger("suggestion:close");break;case 13:n(this).trigger("searchbar:search"),e.preventDefault()}}),e.find("#query").on("focus",function(){n(this).trigger("searchbar:focus")}),e.find("#query").on("keyup",function(e){var t=e.keyCode;(t>=48&&57>=t||t>=65&&90>=t||t>=186&&192>=t||8==t||32==t||220==t)&&n(this).trigger("searchbar:input")}),e.find("#suggestion div").on("mouseover","li",function(){n(this).trigger("suggestion:hover",[n(this)])}),e.find("#suggestion div").on("mouseleave",function(){n(this).trigger("suggestion:leave")}),e.find("#suggestion div").on("click","li",function(){n(this).trigger("suggestion:select"),n(this).trigger("searchbar:search")}),e.find("#suggestion #close").on("click",function(){n(this).trigger("suggestion:close")}),e.find("#search").on("click",function(){n(this).trigger("searchbar:search")}),e.find("#searchLemma").on("click",function(){n(this).trigger("searchbar:searchLemma")}),n("*").on("click",function(t){n(this).parents(".wgt-searchbar")===e?t.stopPropagation():e.trigger("suggestion:close")}),function(){var i=e.find("#query").val();o.ipad()||e.each(function(){n(this).parents(".header-wrapper").length>0&&(n(this).find("#query").val("").focus().val(i),t(n(this)))})}()}var n=e("wiki-common:widget/lib/jquery/jquery.js"),o=e("wiki-common:widget/util/browser.js");i.exports=s});